# ğŸ³ Dockerè·¨ç½‘ç»œéƒ¨ç½²æ–¹æ¡ˆ

## ğŸ¯ æ–¹æ¡ˆæ¦‚è¿°

**åœºæ™¯**: åŸç”µè„‘å’ŒæœåŠ¡å™¨ä¸åœ¨åŒä¸€å±€åŸŸç½‘ï¼Œæ— æ³•ç›´æ¥HTTPä¼ è¾“
**è§£å†³æ–¹æ¡ˆ**: Dockeråˆ†ç¦»å¼éƒ¨ç½² + äº‘ç«¯æ•°æ®ä¼ è¾“

```
åŸç”µè„‘ â†’ äº‘ç«¯å­˜å‚¨ â†’ æœåŠ¡å™¨Dockerå®¹å™¨
  5GB      å‹ç¼©ä¼ è¾“     è‡ªåŠ¨ä¸‹è½½è§£å‹
```

---

## ğŸ“‹ æ ¸å¿ƒæ¶æ„

### ğŸ”§ æŠ€æœ¯æ ˆ
- **å®¹å™¨åŒ–**: Docker + Docker Compose
- **æ•°æ®åˆ†ç¦»**: ä»£ç å’Œæ•°æ®å®Œå…¨åˆ†ç¦»
- **äº‘ç«¯ä¼ è¾“**: ç™¾åº¦ç½‘ç›˜/é˜¿é‡Œäº‘OSS
- **è‡ªåŠ¨éƒ¨ç½²**: ä¸€é”®å¯åŠ¨è„šæœ¬

### ğŸ¯ å…³é”®ä¼˜åŠ¿
- âœ… **è½»é‡é•œåƒ**: 20MBä»£ç é•œåƒï¼Œå¿«é€Ÿä¸‹è½½
- âœ… **è·¨ç½‘ç»œ**: é€šè¿‡äº‘ç«¯ä¸­è½¬æ•°æ®
- âœ… **è‡ªåŠ¨åŒ–**: å®¹å™¨å¯åŠ¨æ—¶è‡ªåŠ¨ä¸‹è½½æ•°æ®
- âœ… **å¯é‡å¤**: ä»»æ„æœåŠ¡å™¨éƒ½èƒ½å¿«é€Ÿéƒ¨ç½²

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡æ•°æ®åŒ…ï¼ˆåŸç”µè„‘æ‰§è¡Œï¼‰

```bash
# åˆ›å»ºéƒ¨ç½²åŒ…
python baidu_uploader.py

# è¾“å‡ºç¤ºä¾‹ï¼š
# âœ… éƒ¨ç½²åŒ…åˆ›å»ºå®Œæˆ: wuwuquant_complete_20241228.tar.gz
# ğŸ“Š æ–‡ä»¶å¤§å°: 850 MB
# ğŸ“ è¯·ä¸Šä¼ åˆ°ç™¾åº¦ç½‘ç›˜/äº‘å­˜å‚¨
```

### ç¬¬äºŒæ­¥ï¼šä¸Šä¼ åˆ°äº‘ç«¯

**æ–¹æ¡ˆA: ç™¾åº¦ç½‘ç›˜ï¼ˆæ¨èä¸ªäººç”¨æˆ·ï¼‰**
```bash
# 1. æ‰‹åŠ¨ä¸Šä¼  wuwuquant_complete_*.tar.gz åˆ°ç™¾åº¦ç½‘ç›˜
# 2. åˆ›å»ºåˆ†äº«é“¾æ¥ï¼ˆæ°¸ä¹…æœ‰æ•ˆï¼‰
# 3. è®°å½•åˆ†äº«é“¾æ¥åœ°å€
```

**æ–¹æ¡ˆB: é˜¿é‡Œäº‘OSSï¼ˆæ¨èç”Ÿäº§ç¯å¢ƒï¼‰**
```bash
# ä¸€æ¬¡æ€§ä¸Šä¼ åˆ°OSS
ossutil cp wuwuquant_complete_*.tar.gz oss://your-bucket/
```

### ç¬¬ä¸‰æ­¥ï¼šæœåŠ¡å™¨Dockeréƒ¨ç½²

```bash
# 1. å‡†å¤‡Dockerç¯å¢ƒ
git clone your-repo
cd wuwuquant

# 2. ä¸€é”®å¿«é€Ÿéƒ¨ç½²
python å¿«é€Ÿéƒ¨ç½².py

# ç¨‹åºä¼šè‡ªåŠ¨ï¼š
# - æ£€æŸ¥Dockerç¯å¢ƒ
# - é…ç½®æ•°æ®æº
# - å¯åŠ¨DockeræœåŠ¡
# - è‡ªåŠ¨ä¸‹è½½æ•°æ®

# 3. è®¿é—®æœåŠ¡
# Webç•Œé¢: http://æœåŠ¡å™¨IP:8501
# APIæ–‡æ¡£: http://æœåŠ¡å™¨IP:8000/docs
```

**æ‰‹åŠ¨é…ç½®æ–¹å¼ï¼š**
```bash
# é…ç½®ç¯å¢ƒå˜é‡
echo "DATA_SOURCE_TYPE=baidu" > .env
echo "DATA_PACKAGE_URL=ä½ çš„ç™¾åº¦ç½‘ç›˜é“¾æ¥" >> .env

# å¯åŠ¨DockeræœåŠ¡
docker-compose -f docker-compose.distributed.yml up -d
```

---

## ğŸ”§ é…ç½®æ–‡ä»¶

### Docker Composeé…ç½®
```yaml
# docker-compose.distributed.yml
version: '3.8'
services:
  stock-prediction:
    build: .
    ports:
      - "8000:8000"
      - "8501:8501"
    volumes:
      - ./datas_em:/app/datas_em
      - ./models:/app/models
    environment:
      - DATA_SOURCE_TYPE=${DATA_SOURCE_TYPE}
      - DATA_PACKAGE_URL=${DATA_PACKAGE_URL}
    command: >
      sh -c "
        python data_downloader.py &&
        uvicorn prediction_service:app --host 0.0.0.0 --port 8000 &
        streamlit run streamlit_app.py --server.port 8501 --server.address 0.0.0.0
      "
```

### ç¯å¢ƒå˜é‡é…ç½®
```bash
# .env æ–‡ä»¶
DATA_SOURCE_TYPE=baidu        # æˆ– aliyun
DATA_PACKAGE_URL=åˆ†äº«é“¾æ¥æˆ–OSSåœ°å€
AUTO_DOWNLOAD=true
```

---

## ğŸ“Š æ•°æ®ä¼ è¾“æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | é€‚ç”¨åœºæ™¯ | æ“ä½œå¤æ‚åº¦ | æˆæœ¬ | é€Ÿåº¦ |
|------|----------|------------|------|------|
| **ç™¾åº¦ç½‘ç›˜** | ä¸ªäººç”¨æˆ· | â­â­ | å…è´¹ | â­â­â­â­ |
| **é˜¿é‡Œäº‘OSS** | ç”Ÿäº§ç¯å¢ƒ | â­â­â­ | ä½ | â­â­â­â­â­ |

---

## ğŸ¯ å®Œæ•´æ“ä½œæµç¨‹

### ğŸ’» åŸç”µè„‘æ“ä½œï¼ˆä¸€æ¬¡æ€§ï¼‰
```bash
# 1. åˆ›å»ºéƒ¨ç½²åŒ…
cd wuwuquant
python baidu_uploader.py

# 2. ä¸Šä¼ åˆ°äº‘ç«¯
# ç™¾åº¦ç½‘ç›˜ï¼šæ‰‹åŠ¨ä¸Šä¼ ï¼Œåˆ›å»ºåˆ†äº«é“¾æ¥
# é˜¿é‡Œäº‘OSSï¼šossutil cp package.tar.gz oss://bucket/
```

### ğŸ–¥ï¸ æœåŠ¡å™¨æ“ä½œï¼ˆé‡å¤ä½¿ç”¨ï¼‰
```bash
# 1. å…‹éš†ä»£ç 
git clone your-repo && cd wuwuquant

# 2. é…ç½®æ•°æ®æº
echo "DATA_PACKAGE_URL=ä½ çš„é“¾æ¥" > .env

# 3. å¯åŠ¨Docker
docker-compose -f docker-compose.distributed.yml up -d

# 4. è®¿é—®æœåŠ¡
# Webç•Œé¢: http://æœåŠ¡å™¨IP:8501
# APIæ–‡æ¡£: http://æœåŠ¡å™¨IP:8000/docs
```

---

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**1. æ•°æ®ä¸‹è½½å¤±è´¥**
```bash
# æ£€æŸ¥æ—¥å¿—
docker-compose logs stock-prediction

# æ‰‹åŠ¨ä¸‹è½½æµ‹è¯•
docker exec -it container_name python data_downloader.py
```

**2. ç«¯å£å ç”¨**
```bash
# ä¿®æ”¹ç«¯å£æ˜ å°„
# åœ¨ docker-compose.distributed.yml ä¸­ä¿®æ”¹:
ports:
  - "8001:8000"  # APIç«¯å£
  - "8502:8501"  # Webç«¯å£
```

**3. å†…å­˜ä¸è¶³**
```bash
# é™åˆ¶å®¹å™¨å†…å­˜ä½¿ç”¨
deploy:
  resources:
    limits:
      memory: 4G
```

---

## ğŸ“ˆ æ€§èƒ½ç›‘æ§

```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker stats

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
docker-compose logs -f stock-prediction

# æŸ¥çœ‹æ•°æ®ä¸‹è½½è¿›åº¦
docker exec -it container_name ls -la datas_em/
```

---

## ğŸ‰ æ€»ç»“

è¿™ä¸ªæ–¹æ¡ˆå®Œç¾è§£å†³äº†ä½ çš„éœ€æ±‚ï¼š
- âœ… **Dockeråˆ†ç¦»å¼éƒ¨ç½²** - ä»£ç å’Œæ•°æ®å®Œå…¨åˆ†ç¦»
- âœ… **è·¨ç½‘ç»œä¼ è¾“** - é€šè¿‡äº‘ç«¯ä¸­è½¬ï¼Œæ— éœ€åŒä¸€å±€åŸŸç½‘
- âœ… **è‡ªåŠ¨åŒ–ç¨‹åº¦é«˜** - ä¸€é”®éƒ¨ç½²ï¼Œè‡ªåŠ¨ä¸‹è½½æ•°æ®
- âœ… **å¯é‡å¤ä½¿ç”¨** - ä»»æ„æœåŠ¡å™¨éƒ½èƒ½å¿«é€Ÿå¯åŠ¨

ç°åœ¨ä½ å¯ä»¥åœ¨ä»»ä½•æœ‰Dockerçš„æœåŠ¡å™¨ä¸Šï¼Œç”¨å‡ æ¡å‘½ä»¤å®Œæˆæ•´ä¸ªç³»ç»Ÿçš„éƒ¨ç½²ï¼ğŸš€