            # æ£€æŸ¥é¢„æµ‹æ¨¡å¼
            prediction_mode = direct_training.get('prediction_mode', 'regression')
            self.prediction_mode = prediction_mode  # ä¿å­˜é¢„æµ‹æ¨¡å¼
            
            # è®¾ç½®ç›®æ ‡å˜é‡
            raw_targets = full_data['next_day_target']
            
            if prediction_mode == 'direction':
                # ğŸ¯ æ–¹å‘é¢„æµ‹æ¨¡å¼ï¼šæ¶¨è·Œå¹… > 0 ä¸ºçœ‹å¤š(1)ï¼Œ<= 0 ä¸ºçœ‹ç©º(0)
                self.y = (raw_targets > 0).astype(int)
                actual_target_column = 'next_day_direction'
                self.logger.info(f"   ğŸ¯ é¢„æµ‹æ¨¡å¼: æ¶¨è·Œæ–¹å‘é¢„æµ‹ï¼ˆäºŒåˆ†ç±»ï¼‰")
                self.logger.info(f"   ğŸ“Š çœ‹å¤šæ ·æœ¬: {(self.y == 1).sum():,} ({(self.y == 1).mean()*100:.1f}%)")
                self.logger.info(f"   ğŸ“Š çœ‹ç©ºæ ·æœ¬: {(self.y == 0).sum():,} ({(self.y == 0).mean()*100:.1f}%)")
            else:
                # ğŸ“ˆ å›å½’é¢„æµ‹æ¨¡å¼ï¼šé¢„æµ‹å…·ä½“æ¶¨è·Œå¹…
                self.y = raw_targets
                actual_target_column = 'next_day_target'
                self.logger.info(f"   ğŸ“ˆ é¢„æµ‹æ¨¡å¼: æ¶¨è·Œå¹…é¢„æµ‹ï¼ˆå›å½’ï¼‰")
                self.logger.info(f"   ğŸ“Š ç›®æ ‡å€¼èŒƒå›´: [{self.y.min():.4f}, {self.y.max():.4f}]")