2025-08-09 20:52:09,065 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-09 20:52:09,065 - __main__ - INFO - 开始加载数据...
2025-08-09 20:52:10,064 - __main__ - INFO - 数据加载完成: X.shape=(407997, 60, 23), y.shape=(407997,)
2025-08-09 20:52:10,080 - __main__ - INFO - 处理异常值...
2025-08-09 20:52:10,847 - __main__ - INFO - 异常值处理完成，移除了 13556 个样本
2025-08-09 20:52:10,852 - __main__ - INFO - 开始预处理时序数据...
2025-08-09 20:53:10,778 - __main__ - INFO - 时序数据预处理完成: (394441, 60, 23) -> (394441, 161)
2025-08-09 20:53:10,778 - __main__ - INFO - 添加技术指标特征...
2025-08-09 20:57:47,873 - __main__ - INFO - 技术指标特征添加完成: (394441, 161) -> (394441, 230)
2025-08-09 20:57:47,877 - __main__ - INFO - 分割数据...
2025-08-09 20:57:48,156 - __main__ - INFO - 数据分割完成: 训练集=276108, 验证集=39444, 测试集=78889
2025-08-09 20:57:48,157 - __main__ - INFO - 使用 standard 方法进行数据标准化...
2025-08-09 20:57:49,167 - __main__ - INFO - 进行特征选择...
2025-08-09 20:57:56,630 - __main__ - INFO - 基于重要性的特征选择完成，选择了 173 个特征
2025-08-09 20:57:56,631 - __main__ - INFO - 开始超参数优化...
2025-08-09 20:57:56,656 - __main__ - ERROR - 训练过程中发生错误: fit() got an unexpected keyword argument 'verbose'
2025-08-09 21:03:07,440 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-09 21:03:07,440 - __main__ - INFO - 开始加载数据...
2025-08-09 21:03:08,370 - __main__ - INFO - 数据加载完成: X.shape=(407997, 60, 23), y.shape=(407997,)
2025-08-09 21:03:08,388 - __main__ - INFO - 处理异常值...
2025-08-09 21:03:09,158 - __main__ - INFO - 异常值处理完成，移除了 13556 个样本
2025-08-09 21:03:09,164 - __main__ - INFO - 开始预处理时序数据...
2025-08-09 21:03:57,653 - __main__ - INFO - 时序数据预处理完成: (394441, 60, 23) -> (394441, 161)
2025-08-09 21:03:57,653 - __main__ - INFO - 添加技术指标特征...
2025-08-09 21:13:55,506 - __main__ - INFO - 技术指标特征添加完成: (394441, 161) -> (394441, 230)
2025-08-09 21:13:55,510 - __main__ - INFO - 分割数据...
2025-08-09 21:13:55,785 - __main__ - INFO - 数据分割完成: 训练集=276108, 验证集=39444, 测试集=78889
2025-08-09 21:13:55,786 - __main__ - INFO - 使用 standard 方法进行数据标准化...
2025-08-09 21:13:56,352 - __main__ - INFO - 进行特征选择...
2025-08-09 21:14:02,597 - __main__ - INFO - 基于重要性的特征选择完成，选择了 168 个特征
2025-08-09 21:14:02,599 - __main__ - INFO - 开始超参数优化...
2025-08-09 21:34:54,140 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-09 21:34:54,140 - __main__ - INFO - 开始加载数据...
2025-08-09 21:34:55,047 - __main__ - INFO - 数据加载完成: X.shape=(407997, 60, 23), y.shape=(407997,)
2025-08-09 21:34:55,063 - __main__ - INFO - 处理异常值...
2025-08-09 21:34:55,828 - __main__ - INFO - 异常值处理完成，移除了 13556 个样本
2025-08-09 21:34:55,833 - __main__ - INFO - 开始预处理时序数据...
2025-08-09 21:41:38,690 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-09 21:41:38,690 - __main__ - INFO - 开始加载数据...
2025-08-09 21:41:38,690 - __main__ - INFO - 检测到CSV格式数据，正在加载...
2025-08-09 21:41:39,189 - __main__ - INFO - CSV数据加载完成: X.shape=(7571, 1380), y.shape=(7571,)
2025-08-09 21:41:39,189 - __main__ - INFO - 处理异常值...
2025-08-09 21:41:39,210 - __main__ - INFO - 异常值处理完成，移除了 249 个样本
2025-08-09 21:41:39,210 - __main__ - INFO - 开始预处理时序数据...
2025-08-09 21:41:39,210 - __main__ - INFO - 检测到2D数据格式（可能来自CSV），检查是否需要时序处理...
2025-08-09 21:41:39,210 - __main__ - WARNING - 无法重新构造时序结构，将使用2D数据直接处理
2025-08-09 21:41:39,210 - __main__ - INFO - 添加技术指标特征...
2025-08-09 21:41:39,210 - __main__ - ERROR - 训练过程中发生错误: too many indices for array: array is 2-dimensional, but 3 were indexed
2025-08-09 21:42:29,923 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-09 21:42:29,923 - __main__ - INFO - 开始加载数据...
2025-08-09 21:42:29,923 - __main__ - INFO - 检测到CSV格式数据，正在加载...
2025-08-09 21:42:30,412 - __main__ - INFO - CSV数据加载完成: X.shape=(7571, 1380), y.shape=(7571,)
2025-08-09 21:42:30,413 - __main__ - INFO - 处理异常值...
2025-08-09 21:42:30,433 - __main__ - INFO - 异常值处理完成，移除了 249 个样本
2025-08-09 21:42:30,433 - __main__ - INFO - 开始预处理时序数据...
2025-08-09 21:42:30,433 - __main__ - INFO - 检测到2D数据格式（可能来自CSV），检查是否需要时序处理...
2025-08-09 21:42:30,433 - __main__ - WARNING - 无法重新构造时序结构，将使用2D数据直接处理
2025-08-09 21:42:30,433 - __main__ - WARNING - 技术指标特征需要3D时序数据，当前数据已被展平，跳过技术特征计算
2025-08-09 21:42:30,433 - __main__ - INFO - 分割数据...
2025-08-09 21:42:30,459 - __main__ - INFO - 数据分割完成: 训练集=5124, 验证集=733, 测试集=1465
2025-08-09 21:42:30,459 - __main__ - INFO - 使用 standard 方法进行数据标准化...
2025-08-09 21:42:30,515 - __main__ - INFO - 进行特征选择...
2025-08-09 21:42:32,583 - __main__ - INFO - 基于重要性的特征选择完成，选择了 737 个特征
2025-08-09 21:42:32,584 - __main__ - INFO - 开始超参数优化...
2025-08-09 21:42:53,375 - __main__ - ERROR - 训练过程中发生错误: [Errno 32] Broken pipe
2025-08-09 22:05:18,700 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-09 22:05:18,700 - __main__ - INFO - 开始加载数据...
2025-08-09 22:05:19,600 - __main__ - INFO - 数据加载完成: X.shape=(407997, 60, 23), y.shape=(407997,)
2025-08-09 22:05:19,617 - __main__ - INFO - 处理异常值...
2025-08-09 22:05:20,381 - __main__ - INFO - 异常值处理完成，移除了 13556 个样本
2025-08-09 22:05:20,387 - __main__ - INFO - 开始预处理时序数据...
2025-08-09 22:11:27,850 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-09 22:11:27,850 - __main__ - INFO - 开始加载数据...
2025-08-09 22:11:27,850 - __main__ - ERROR - 训练过程中发生错误: 数据目录不存在: ./data/processed/processed_20250115_120000
2025-08-09 22:12:24,649 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-09 22:12:24,649 - __main__ - INFO - 开始加载数据...
2025-08-09 22:12:24,649 - __main__ - INFO - 使用完整数据文件加载数据...
2025-08-09 22:12:25,107 - __main__ - INFO - 数据加载完成: X.shape=(7571, 1380), y.shape=(7571,)
2025-08-09 22:12:25,107 - __main__ - INFO - 验证数据完整性...
2025-08-09 22:12:25,117 - __main__ - INFO - 数据验证完成
2025-08-09 22:12:25,117 - __main__ - INFO - 数据信息: CSV 格式
2025-08-09 22:12:25,118 - __main__ - INFO - 处理异常值...
2025-08-09 22:12:25,138 - __main__ - INFO - 异常值处理完成，移除了 249 个样本
2025-08-09 22:12:25,139 - __main__ - INFO - 开始预处理时序数据...
2025-08-09 22:12:25,139 - __main__ - ERROR - 训练过程中发生错误: tuple index out of range
2025-08-09 22:12:29,332 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-09 22:12:29,332 - __main__ - INFO - 开始加载数据...
2025-08-09 22:12:29,332 - __main__ - INFO - 使用完整数据文件加载数据...
2025-08-09 22:12:29,788 - __main__ - INFO - 数据加载完成: X.shape=(7571, 1380), y.shape=(7571,)
2025-08-09 22:12:29,788 - __main__ - INFO - 验证数据完整性...
2025-08-09 22:12:29,798 - __main__ - INFO - 数据验证完成
2025-08-09 22:12:29,799 - __main__ - INFO - 数据信息: CSV 格式
2025-08-09 22:12:29,799 - __main__ - INFO - 处理异常值...
2025-08-09 22:12:29,819 - __main__ - INFO - 异常值处理完成，移除了 249 个样本
2025-08-09 22:12:29,820 - __main__ - INFO - 开始预处理时序数据...
2025-08-09 22:12:29,820 - __main__ - ERROR - 训练过程中发生错误: tuple index out of range
2025-08-09 22:13:48,161 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-09 22:13:48,161 - __main__ - INFO - 开始加载数据...
2025-08-09 22:13:48,161 - __main__ - INFO - 使用完整数据文件加载数据...
2025-08-09 22:13:48,651 - __main__ - INFO - 数据加载完成: X.shape=(7571, 1380), y.shape=(7571,)
2025-08-09 22:13:48,651 - __main__ - INFO - 验证数据完整性...
2025-08-09 22:13:48,661 - __main__ - INFO - 数据验证完成
2025-08-09 22:13:48,662 - __main__ - INFO - 数据信息: CSV 格式
2025-08-09 22:13:48,662 - __main__ - INFO - 处理异常值...
2025-08-09 22:13:48,682 - __main__ - INFO - 异常值处理完成，移除了 249 个样本
2025-08-09 22:13:48,683 - __main__ - INFO - 开始预处理时序数据...
2025-08-09 22:13:48,683 - __main__ - INFO - 输入数据形状: (7322, 1380)
2025-08-09 22:13:48,683 - __main__ - INFO - 检测到2D数据，跳过时序预处理
2025-08-09 22:13:48,683 - __main__ - INFO - 时序数据预处理完成: (7322, 1380) -> (7322, 1380)
2025-08-09 22:13:48,683 - __main__ - INFO - 原始数据已为2D格式，跳过技术指标特征计算
2025-08-09 22:13:48,683 - __main__ - INFO - 分割数据...
2025-08-09 22:13:48,708 - __main__ - INFO - 数据分割完成: 训练集=5124, 验证集=733, 测试集=1465
2025-08-09 22:13:48,708 - __main__ - INFO - 使用 standard 方法进行数据标准化...
2025-08-09 22:13:48,770 - __main__ - INFO - 进行特征选择...
2025-08-09 22:13:50,875 - __main__ - INFO - 基于重要性的特征选择完成，选择了 737 个特征
2025-08-09 22:13:50,876 - __main__ - INFO - 开始超参数优化...
2025-08-09 22:17:50,483 - __main__ - INFO - 超参数优化完成，最佳参数: {'num_leaves': 156, 'learning_rate': 0.05326897230469745, 'feature_fraction': 0.5028985323087748, 'bagging_fraction': 0.5427338490575062, 'min_data_in_leaf': 16, 'lambda_l1': 7.897988735285244, 'lambda_l2': 0.171210704839041}
2025-08-09 22:17:50,483 - __main__ - INFO - 开始训练LightGBM模型...
2025-08-09 22:17:51,346 - __main__ - INFO - 模型训练完成
2025-08-09 22:17:51,347 - __main__ - INFO - 评估模型性能...
2025-08-09 22:17:51,349 - __main__ - INFO - RMSE: 1.8937
2025-08-09 22:17:51,349 - __main__ - INFO - MAE: 1.2980
2025-08-09 22:17:51,349 - __main__ - INFO - R2_SCORE: 0.1794
2025-08-09 22:17:51,350 - __main__ - INFO - EXPLAINED_VARIANCE: 0.1804
2025-08-09 22:17:51,350 - __main__ - INFO - MAPE: inf
2025-08-09 22:17:51,350 - __main__ - INFO - 保存模型...
2025-08-09 22:17:51,354 - __main__ - INFO - 模型已保存到: ./models/lightgbm
2025-08-09 22:17:51,359 - __main__ - INFO - 结果已保存到: ./results/lightgbm
2025-08-09 22:17:51,359 - __main__ - INFO - 训练流程完成！
2025-08-09 22:26:14,593 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-09 22:26:14,594 - __main__ - INFO - 执行步骤: 加载数据
2025-08-09 22:26:14,594 - __main__ - INFO - 开始加载数据...
2025-08-09 22:26:14,594 - __main__ - INFO - 使用完整数据文件加载数据...
2025-08-09 22:26:14,594 - __main__ - INFO - 正在读取CSV文件...
2025-08-09 22:26:15,048 - __main__ - INFO - 数据加载完成: X.shape=(7571, 1380), y.shape=(7571,)
2025-08-09 22:26:15,048 - __main__ - INFO - 验证数据完整性...
2025-08-09 22:26:15,058 - __main__ - INFO - 数据验证完成
2025-08-09 22:26:15,058 - __main__ - INFO - 数据信息: CSV 格式
2025-08-09 22:26:15,059 - __main__ - INFO - 执行步骤: 处理异常值
2025-08-09 22:26:15,059 - __main__ - INFO - 处理异常值...
2025-08-09 22:26:15,079 - __main__ - INFO - 异常值处理完成，移除了 249 个样本
2025-08-09 22:26:15,079 - __main__ - INFO - 执行步骤: 预处理数据
2025-08-09 22:26:15,079 - __main__ - INFO - 开始预处理时序数据...
2025-08-09 22:26:15,080 - __main__ - INFO - 输入数据形状: (7322, 1380)
2025-08-09 22:26:15,080 - __main__ - INFO - 检测到2D数据，跳过时序预处理
2025-08-09 22:26:15,080 - __main__ - INFO - 时序数据预处理完成: (7322, 1380) -> (7322, 1380)
2025-08-09 22:26:15,080 - __main__ - INFO - 执行步骤: 添加技术特征
2025-08-09 22:26:15,080 - __main__ - INFO - 原始数据已为2D格式，跳过技术指标特征计算
2025-08-09 22:26:15,080 - __main__ - INFO - 执行步骤: 分割数据
2025-08-09 22:26:15,080 - __main__ - INFO - 分割数据...
2025-08-09 22:26:15,107 - __main__ - INFO - 数据分割完成: 训练集=5124, 验证集=733, 测试集=1465
2025-08-09 22:26:15,107 - __main__ - INFO - 执行步骤: 标准化数据
2025-08-09 22:26:15,107 - __main__ - INFO - 使用 standard 方法进行数据标准化...
2025-08-09 22:26:15,166 - __main__ - INFO - 执行步骤: 特征选择
2025-08-09 22:26:15,166 - __main__ - INFO - 进行特征选择...
2025-08-09 22:26:17,839 - __main__ - INFO - 基于重要性的特征选择完成，选择了 737 个特征
2025-08-09 22:26:17,840 - __main__ - INFO - 执行步骤: 超参数优化
2025-08-09 22:26:17,841 - __main__ - INFO - 开始超参数优化...
2025-08-09 22:31:21,679 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-09 22:31:21,680 - __main__ - INFO - 执行步骤: 加载数据
2025-08-09 22:31:21,680 - __main__ - INFO - 开始加载数据...
2025-08-09 22:31:21,680 - __main__ - INFO - 使用完整数据文件加载数据...
2025-08-09 22:31:21,680 - __main__ - INFO - 正在读取CSV文件...
2025-08-09 22:31:22,135 - __main__ - INFO - 数据加载完成: X.shape=(7571, 1380), y.shape=(7571,)
2025-08-09 22:31:22,135 - __main__ - INFO - 验证数据完整性...
2025-08-09 22:31:22,145 - __main__ - INFO - 数据验证完成
2025-08-09 22:31:22,146 - __main__ - INFO - 数据信息: CSV 格式
2025-08-09 22:31:22,146 - __main__ - INFO - 执行步骤: 处理异常值
2025-08-09 22:31:22,146 - __main__ - INFO - 处理异常值...
2025-08-09 22:31:22,166 - __main__ - INFO - 异常值处理完成，移除了 249 个样本
2025-08-09 22:31:22,167 - __main__ - INFO - 执行步骤: 预处理数据
2025-08-09 22:31:22,167 - __main__ - INFO - 开始预处理时序数据...
2025-08-09 22:31:22,167 - __main__ - INFO - 输入数据形状: (7322, 1380)
2025-08-09 22:31:22,167 - __main__ - INFO - 检测到2D数据，跳过时序预处理
2025-08-09 22:31:22,167 - __main__ - INFO - 时序数据预处理完成: (7322, 1380) -> (7322, 1380)
2025-08-09 22:31:22,167 - __main__ - INFO - 执行步骤: 添加技术特征
2025-08-09 22:31:22,167 - __main__ - INFO - 原始数据已为2D格式，跳过技术指标特征计算
2025-08-09 22:31:22,167 - __main__ - INFO - 执行步骤: 分割数据
2025-08-09 22:31:22,167 - __main__ - INFO - 分割数据...
2025-08-09 22:31:22,192 - __main__ - INFO - 数据分割完成: 训练集=5124, 验证集=733, 测试集=1465
2025-08-09 22:31:22,192 - __main__ - INFO - 执行步骤: 标准化数据
2025-08-09 22:31:22,193 - __main__ - INFO - 使用 standard 方法进行数据标准化...
2025-08-09 22:31:22,251 - __main__ - INFO - 执行步骤: 特征选择
2025-08-09 22:31:22,251 - __main__ - INFO - 进行特征选择...
2025-08-09 22:31:24,942 - __main__ - INFO - 基于重要性的特征选择完成，选择了 737 个特征
2025-08-09 22:31:24,945 - __main__ - INFO - 执行步骤: 超参数优化
2025-08-09 22:31:24,945 - __main__ - INFO - 开始超参数优化...
2025-08-09 22:32:59,756 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-09 22:33:02,466 - __main__ - INFO - 开始超参数优化...
2025-08-09 22:33:30,783 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-09 22:33:34,023 - __main__ - INFO - 开始超参数优化...
2025-08-09 22:36:50,988 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-09 22:36:54,275 - __main__ - INFO - 开始超参数优化...
2025-08-09 22:38:15,054 - __main__ - INFO - 超参数优化完成，最佳RMSE: 1.9296
2025-08-09 22:38:15,054 - __main__ - INFO - 最佳参数: {'num_leaves': 86, 'learning_rate': 0.06114310169848183, 'feature_fraction': 0.533116440323014, 'bagging_fraction': 0.6711621797088959, 'min_data_in_leaf': 35, 'lambda_l1': 3.5716521934347707, 'lambda_l2': 7.17261648936343}
2025-08-09 22:38:15,055 - __main__ - INFO - 开始训练LightGBM模型...
2025-08-09 22:38:15,055 - __main__ - INFO - 🚀 开始模型训练...
2025-08-09 22:38:17,304 - __main__ - INFO - 模型训练完成
2025-08-09 22:38:17,318 - __main__ - INFO - 训练流程完成！
2025-08-09 22:42:19,555 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-09 22:42:55,084 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-09 22:44:20,955 - __main__ - INFO - 🚀 开始模型训练...
2025-08-09 22:44:22,911 - __main__ - INFO - 模型训练完成
2025-08-09 23:55:58,787 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-09 23:57:12,023 - __main__ - INFO - 🚀 开始模型训练...
2025-08-09 23:57:13,433 - __main__ - INFO - 模型训练完成
2025-08-10 00:19:50,042 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-10 00:21:05,790 - __main__ - INFO - 🚀 开始模型训练...
2025-08-10 00:21:07,306 - __main__ - INFO - 模型训练完成
2025-08-10 00:32:53,116 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-10 00:34:09,297 - __main__ - INFO - 🚀 开始模型训练...
2025-08-10 00:34:10,713 - __main__ - INFO - 模型训练完成
2025-08-10 01:03:39,952 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-10 01:03:41,182 - __main__ - ERROR - 训练过程中发生错误: Input X contains infinity or a value too large for dtype('float64').
2025-08-10 01:07:02,633 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-10 01:07:43,830 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-10 01:09:02,185 - __main__ - INFO - 🚀 开始模型训练...
2025-08-10 01:09:03,488 - __main__ - INFO - 模型训练完成
2025-08-10 01:21:58,854 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-10 01:28:48,153 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-10 01:30:05,315 - __main__ - INFO - 🚀 开始模型训练...
2025-08-10 01:30:07,561 - __main__ - INFO - 模型训练完成
2025-08-10 01:31:03,694 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-10 01:32:18,788 - __main__ - INFO - 🚀 开始模型训练...
2025-08-10 01:32:20,720 - __main__ - INFO - 模型训练完成
2025-08-10 01:32:20,789 - __main__ - ERROR - 训练过程中发生错误: [Errno 2] No such file or directory: './results/lightgbm/training_007/metrics.json'
2025-08-10 02:01:06,448 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-10 02:01:06,448 - __main__ - ERROR - 训练过程中发生错误: 数据目录不存在: ./data/datas_processed/processed_20250810_012123
2025-08-10 02:02:23,976 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-10 02:23:44,854 - __main__ - INFO - 🚀 开始模型训练...
2025-08-10 02:24:01,658 - __main__ - INFO - 模型训练完成
2025-08-10 02:47:00,596 - lightgbm_train - INFO - 开始加载数据...
2025-08-10 02:47:00,596 - lightgbm_train - INFO - 使用完整数据文件加载数据...
2025-08-10 02:47:00,596 - lightgbm_train - INFO - 正在读取CSV文件...
2025-08-10 02:47:23,436 - lightgbm_train - INFO - 处理时序窗口数据...
2025-08-10 02:47:23,436 - lightgbm_train - INFO - 检测到时序窗口数据: 30 个时间步, 28 种特征类型
2025-08-10 02:47:23,436 - lightgbm_train - INFO - 时间窗口范围: step_00 到 step_29
2025-08-10 02:47:23,448 - lightgbm_train - INFO - 数据包含 5158 只股票
2025-08-10 02:47:23,448 - lightgbm_train - INFO - 每只股票的样本数量 - 最少: 6, 最多: 110, 平均: 109.1
2025-08-10 02:47:24,055 - lightgbm_train - INFO - 提取特征列 840 个: ['step_00_个股_开盘价', 'step_00_个股_收盘价', 'step_00_个股_最高价', 'step_00_个股_成交量', 'step_00_个股_涨跌幅']...
2025-08-10 02:47:24,055 - lightgbm_train - INFO - 数据加载完成: X.shape=(562593, 840), y.shape=(562593,)
2025-08-10 02:47:24,055 - lightgbm_train - INFO - 验证数据完整性...
2025-08-10 02:47:24,882 - lightgbm_train - INFO - 数据验证完成
2025-08-10 02:47:24,896 - lightgbm_train - INFO - 数据信息: CSV 格式
2025-08-10 02:47:24,900 - lightgbm_train - INFO - 处理异常值...
2025-08-10 02:47:25,813 - lightgbm_train - INFO - 异常值处理完成，移除了 17222 个样本
2025-08-10 02:47:25,822 - lightgbm_train - INFO - 开始预处理时序数据...
2025-08-10 02:47:25,822 - lightgbm_train - INFO - 输入数据形状: (545371, 840)
2025-08-10 02:47:25,822 - lightgbm_train - INFO - 检测到2D时序窗口数据，进行特征名称处理...
2025-08-10 02:47:25,822 - lightgbm_train - INFO - 使用时序窗口特征名称: 840 个step特征
2025-08-10 02:47:25,822 - lightgbm_train - INFO - 时序窗口结构: 30 个时间步 × 28 种特征
2025-08-10 02:47:25,822 - lightgbm_train - INFO - 时序数据预处理完成: (545371, 840) -> (545371, 840)
2025-08-10 02:47:25,822 - lightgbm_train - INFO - 为时序窗口数据计算技术指标...
2025-08-10 02:47:25,822 - lightgbm_train - INFO - 发现 7 种价格特征, 4 种成交量特征
2025-08-10 02:48:59,887 - lightgbm_train - INFO - 时序窗口技术指标特征添加完成: (545371, 840) -> (545371, 868)
2025-08-10 02:48:59,887 - lightgbm_train - INFO - 分割数据...
2025-08-10 02:49:01,105 - lightgbm_train - INFO - 数据分割完成: 训练集=381759, 验证集=54537, 测试集=109075
2025-08-10 02:49:01,109 - lightgbm_train - INFO - 数据清理：处理无穷值和NaN值...
2025-08-10 02:49:19,531 - lightgbm_train - INFO - 训练集数据清理完成
2025-08-10 02:49:19,577 - lightgbm_train - INFO - 验证集数据清理完成
2025-08-10 02:49:19,670 - lightgbm_train - INFO - 测试集数据清理完成
2025-08-10 02:49:19,670 - lightgbm_train - INFO - 使用 standard 方法进行数据标准化...
2025-08-10 02:49:22,465 - lightgbm_train - INFO - 进行特征选择...
2025-08-10 02:50:00,993 - lightgbm_train - INFO - 基于重要性选择了 590 个特征
2025-08-10 02:50:02,813 - lightgbm_train - INFO - 基于相关性移除了 156 个高相关特征
2025-08-10 02:50:02,816 - lightgbm_train - INFO - 特征选择完成：868 -> 434 个特征
2025-08-10 02:50:02,821 - lightgbm_train - INFO - 🚀 开始模型训练...
2025-08-10 02:50:11,330 - lightgbm_train - INFO - 模型训练完成
2025-08-10 02:50:11,330 - lightgbm_train - INFO - 评估模型性能...
2025-08-10 02:50:11,401 - lightgbm_train - INFO - MAPE计算时过滤了3260个接近零值的样本
2025-08-10 02:50:11,416 - lightgbm_train - INFO - 开始加载数据...
2025-08-10 02:50:11,416 - lightgbm_train - INFO - 使用完整数据文件加载数据...
2025-08-10 02:50:11,416 - lightgbm_train - INFO - 正在读取CSV文件...
2025-08-10 02:50:33,359 - lightgbm_train - INFO - 处理时序窗口数据...
2025-08-10 02:50:33,359 - lightgbm_train - INFO - 检测到时序窗口数据: 30 个时间步, 28 种特征类型
2025-08-10 02:50:33,359 - lightgbm_train - INFO - 时间窗口范围: step_00 到 step_29
2025-08-10 02:50:33,372 - lightgbm_train - INFO - 数据包含 5158 只股票
2025-08-10 02:50:33,372 - lightgbm_train - INFO - 每只股票的样本数量 - 最少: 6, 最多: 110, 平均: 109.1
2025-08-10 02:50:33,977 - lightgbm_train - INFO - 提取特征列 840 个: ['step_00_个股_开盘价', 'step_00_个股_收盘价', 'step_00_个股_最高价', 'step_00_个股_成交量', 'step_00_个股_涨跌幅']...
2025-08-10 02:50:33,977 - lightgbm_train - INFO - 数据加载完成: X.shape=(562593, 840), y.shape=(562593,)
2025-08-10 02:50:33,977 - lightgbm_train - INFO - 验证数据完整性...
2025-08-10 02:50:34,793 - lightgbm_train - INFO - 数据验证完成
2025-08-10 02:50:34,808 - lightgbm_train - INFO - 数据信息: CSV 格式
2025-08-10 02:50:34,816 - lightgbm_train - INFO - 处理异常值...
2025-08-10 02:50:35,751 - lightgbm_train - INFO - 第一阶段：调整了 10940 个极端异常值
2025-08-10 02:50:35,752 - lightgbm_train - INFO - 多阶段异常值处理完成，总共处理了 10940 个样本
2025-08-10 02:50:35,760 - lightgbm_train - INFO - 开始预处理时序数据...
2025-08-10 02:50:35,760 - lightgbm_train - INFO - 输入数据形状: (562593, 840)
2025-08-10 02:50:35,760 - lightgbm_train - INFO - 检测到2D时序窗口数据，进行特征名称处理...
2025-08-10 02:50:35,760 - lightgbm_train - INFO - 使用时序窗口特征名称: 840 个step特征
2025-08-10 02:50:35,760 - lightgbm_train - INFO - 时序窗口结构: 30 个时间步 × 28 种特征
2025-08-10 02:50:35,760 - lightgbm_train - INFO - 时序数据预处理完成: (562593, 840) -> (562593, 840)
2025-08-10 02:50:35,765 - lightgbm_train - INFO - 为时序窗口数据计算技术指标...
2025-08-10 02:50:35,765 - lightgbm_train - INFO - 发现 7 种价格特征, 4 种成交量特征
2025-08-10 02:52:13,219 - lightgbm_train - INFO - 时序窗口技术指标特征添加完成: (562593, 840) -> (562593, 868)
2025-08-10 02:52:13,220 - lightgbm_train - INFO - 分割数据...
2025-08-10 02:52:14,548 - lightgbm_train - INFO - 数据分割完成: 训练集=393815, 验证集=84389, 测试集=84389
2025-08-10 02:52:14,553 - lightgbm_train - INFO - 数据清理：处理无穷值和NaN值...
2025-08-10 02:52:33,739 - lightgbm_train - INFO - 训练集数据清理完成
2025-08-10 02:52:33,810 - lightgbm_train - INFO - 验证集数据清理完成
2025-08-10 02:52:33,881 - lightgbm_train - INFO - 测试集数据清理完成
2025-08-10 02:52:33,881 - lightgbm_train - INFO - 使用 robust 方法进行数据标准化...
2025-08-10 02:52:45,039 - lightgbm_train - INFO - 进行特征选择...
2025-08-10 02:53:20,975 - lightgbm_train - INFO - 基于重要性选择了 577 个特征
2025-08-10 02:53:23,876 - lightgbm_train - INFO - 基于相关性移除了 235 个高相关特征
2025-08-10 02:53:23,879 - lightgbm_train - INFO - 开始递归特征消除，目标特征数: 200
2025-08-10 02:53:46,987 - lightgbm_train - INFO - RFE选择了 200 个特征
2025-08-10 02:53:46,989 - lightgbm_train - INFO - 特征选择完成：868 -> 200 个特征
2025-08-10 02:53:46,993 - lightgbm_train - INFO - 🚀 开始模型训练...
2025-08-10 02:53:51,512 - lightgbm_train - INFO - 模型训练完成
2025-08-10 02:53:51,512 - lightgbm_train - INFO - 评估模型性能...
2025-08-10 02:53:51,571 - lightgbm_train - INFO - MAPE计算时过滤了2449个接近零值的样本
2025-08-10 02:59:26,488 - lightgbm_train - INFO - 开始加载数据...
2025-08-10 02:59:26,488 - lightgbm_train - INFO - 使用完整数据文件加载数据...
2025-08-10 02:59:26,488 - lightgbm_train - INFO - 正在读取CSV文件...
2025-08-10 02:59:48,998 - lightgbm_train - INFO - 处理时序窗口数据...
2025-08-10 02:59:48,999 - lightgbm_train - INFO - 检测到时序窗口数据: 30 个时间步, 28 种特征类型
2025-08-10 02:59:48,999 - lightgbm_train - INFO - 时间窗口范围: step_00 到 step_29
2025-08-10 02:59:49,011 - lightgbm_train - INFO - 数据包含 5158 只股票
2025-08-10 02:59:49,011 - lightgbm_train - INFO - 每只股票的样本数量 - 最少: 6, 最多: 110, 平均: 109.1
2025-08-10 02:59:49,622 - lightgbm_train - INFO - 提取特征列 840 个: ['step_00_个股_开盘价', 'step_00_个股_收盘价', 'step_00_个股_最高价', 'step_00_个股_成交量', 'step_00_个股_涨跌幅']...
2025-08-10 02:59:49,622 - lightgbm_train - INFO - 数据加载完成: X.shape=(562593, 840), y.shape=(562593,)
2025-08-10 02:59:49,622 - lightgbm_train - INFO - 验证数据完整性...
2025-08-10 02:59:50,530 - lightgbm_train - INFO - 数据验证完成
2025-08-10 02:59:50,544 - lightgbm_train - INFO - 数据信息: CSV 格式
2025-08-10 02:59:50,548 - lightgbm_train - INFO - 处理异常值...
2025-08-10 02:59:51,447 - lightgbm_train - INFO - 异常值处理完成，移除了 17222 个样本
2025-08-10 02:59:51,456 - lightgbm_train - INFO - 开始预处理时序数据...
2025-08-10 02:59:51,456 - lightgbm_train - INFO - 输入数据形状: (545371, 840)
2025-08-10 02:59:51,456 - lightgbm_train - INFO - 检测到2D时序窗口数据，进行特征名称处理...
2025-08-10 02:59:51,456 - lightgbm_train - INFO - 使用时序窗口特征名称: 840 个step特征
2025-08-10 02:59:51,456 - lightgbm_train - INFO - 时序窗口结构: 30 个时间步 × 28 种特征
2025-08-10 02:59:51,456 - lightgbm_train - INFO - 时序数据预处理完成: (545371, 840) -> (545371, 840)
2025-08-10 02:59:51,456 - lightgbm_train - INFO - 为时序窗口数据计算技术指标...
2025-08-10 02:59:51,456 - lightgbm_train - INFO - 发现 7 种价格特征, 4 种成交量特征
2025-08-10 03:01:29,018 - lightgbm_train - INFO - 时序窗口技术指标特征添加完成: (545371, 840) -> (545371, 868)
2025-08-10 03:01:29,018 - lightgbm_train - INFO - 分割数据...
2025-08-10 03:01:30,229 - lightgbm_train - INFO - 数据分割完成: 训练集=381759, 验证集=54537, 测试集=109075
2025-08-10 03:01:30,232 - lightgbm_train - INFO - 数据清理：处理无穷值和NaN值...
2025-08-10 03:01:48,322 - lightgbm_train - INFO - 训练集数据清理完成
2025-08-10 03:01:48,367 - lightgbm_train - INFO - 验证集数据清理完成
2025-08-10 03:01:48,458 - lightgbm_train - INFO - 测试集数据清理完成
2025-08-10 03:01:48,458 - lightgbm_train - INFO - 使用 standard 方法进行数据标准化...
2025-08-10 03:01:51,226 - lightgbm_train - INFO - 进行特征选择...
2025-08-10 03:02:29,440 - lightgbm_train - INFO - 基于重要性选择了 590 个特征
2025-08-10 03:02:31,288 - lightgbm_train - INFO - 基于相关性移除了 156 个高相关特征
2025-08-10 03:02:31,291 - lightgbm_train - INFO - 特征选择完成：868 -> 434 个特征
2025-08-10 03:02:31,295 - lightgbm_train - INFO - 🚀 开始模型训练...
2025-08-10 03:02:39,711 - lightgbm_train - INFO - 模型训练完成
2025-08-10 03:02:39,711 - lightgbm_train - INFO - 评估模型性能...
2025-08-10 03:02:39,779 - lightgbm_train - INFO - MAPE计算时过滤了3260个接近零值的样本
2025-08-10 03:02:39,794 - lightgbm_train - INFO - 开始加载数据...
2025-08-10 03:02:39,794 - lightgbm_train - INFO - 使用完整数据文件加载数据...
2025-08-10 03:02:39,794 - lightgbm_train - INFO - 正在读取CSV文件...
2025-08-10 03:03:01,859 - lightgbm_train - INFO - 处理时序窗口数据...
2025-08-10 03:03:01,859 - lightgbm_train - INFO - 检测到时序窗口数据: 30 个时间步, 28 种特征类型
2025-08-10 03:03:01,859 - lightgbm_train - INFO - 时间窗口范围: step_00 到 step_29
2025-08-10 03:03:01,872 - lightgbm_train - INFO - 数据包含 5158 只股票
2025-08-10 03:03:01,872 - lightgbm_train - INFO - 每只股票的样本数量 - 最少: 6, 最多: 110, 平均: 109.1
2025-08-10 03:03:02,472 - lightgbm_train - INFO - 提取特征列 840 个: ['step_00_个股_开盘价', 'step_00_个股_收盘价', 'step_00_个股_最高价', 'step_00_个股_成交量', 'step_00_个股_涨跌幅']...
2025-08-10 03:03:02,472 - lightgbm_train - INFO - 数据加载完成: X.shape=(562593, 840), y.shape=(562593,)
2025-08-10 03:03:02,472 - lightgbm_train - INFO - 验证数据完整性...
2025-08-10 03:03:03,292 - lightgbm_train - INFO - 数据验证完成
2025-08-10 03:03:03,307 - lightgbm_train - INFO - 数据信息: CSV 格式
2025-08-10 03:03:03,315 - lightgbm_train - INFO - 处理异常值...
2025-08-10 03:03:04,248 - lightgbm_train - INFO - 第一阶段：调整了 10940 个极端异常值
2025-08-10 03:03:04,249 - lightgbm_train - INFO - 多阶段异常值处理完成，总共处理了 10940 个样本
2025-08-10 03:03:04,258 - lightgbm_train - INFO - 开始预处理时序数据...
2025-08-10 03:03:04,258 - lightgbm_train - INFO - 输入数据形状: (562593, 840)
2025-08-10 03:03:04,258 - lightgbm_train - INFO - 检测到2D时序窗口数据，进行特征名称处理...
2025-08-10 03:03:04,258 - lightgbm_train - INFO - 使用时序窗口特征名称: 840 个step特征
2025-08-10 03:03:04,258 - lightgbm_train - INFO - 时序窗口结构: 30 个时间步 × 28 种特征
2025-08-10 03:03:04,258 - lightgbm_train - INFO - 时序数据预处理完成: (562593, 840) -> (562593, 840)
2025-08-10 03:03:04,262 - lightgbm_train - INFO - 为时序窗口数据计算技术指标...
2025-08-10 03:03:04,262 - lightgbm_train - INFO - 发现 7 种价格特征, 4 种成交量特征
2025-08-10 03:04:43,269 - lightgbm_train - INFO - 时序窗口技术指标特征添加完成: (562593, 840) -> (562593, 868)
2025-08-10 03:04:43,269 - lightgbm_train - INFO - 分割数据...
2025-08-10 03:04:44,595 - lightgbm_train - INFO - 数据分割完成: 训练集=393815, 验证集=84389, 测试集=84389
2025-08-10 03:04:44,600 - lightgbm_train - INFO - 数据清理：处理无穷值和NaN值...
2025-08-10 03:05:03,441 - lightgbm_train - INFO - 训练集数据清理完成
2025-08-10 03:05:03,512 - lightgbm_train - INFO - 验证集数据清理完成
2025-08-10 03:05:03,583 - lightgbm_train - INFO - 测试集数据清理完成
2025-08-10 03:05:03,583 - lightgbm_train - INFO - 使用 robust 方法进行数据标准化...
2025-08-10 03:05:14,728 - lightgbm_train - INFO - 进行特征选择...
2025-08-10 03:05:50,724 - lightgbm_train - INFO - 基于重要性选择了 577 个特征
2025-08-10 03:05:53,532 - lightgbm_train - INFO - 基于相关性移除了 235 个高相关特征
2025-08-10 03:05:53,534 - lightgbm_train - INFO - 开始递归特征消除，目标特征数: 200
2025-08-10 03:06:16,911 - lightgbm_train - INFO - RFE选择了 200 个特征
2025-08-10 03:06:16,913 - lightgbm_train - INFO - 特征选择完成：868 -> 200 个特征
2025-08-10 03:06:16,918 - lightgbm_train - INFO - 🚀 开始模型训练...
2025-08-10 03:06:21,559 - lightgbm_train - INFO - 模型训练完成
2025-08-10 03:06:21,559 - lightgbm_train - INFO - 评估模型性能...
2025-08-10 03:06:21,619 - lightgbm_train - INFO - MAPE计算时过滤了2449个接近零值的样本
2025-08-10 03:06:21,631 - lightgbm_train - INFO - 开始加载数据...
2025-08-10 03:06:21,631 - lightgbm_train - INFO - 使用完整数据文件加载数据...
2025-08-10 03:06:21,631 - lightgbm_train - INFO - 正在读取CSV文件...
2025-08-10 03:06:43,476 - lightgbm_train - INFO - 处理时序窗口数据...
2025-08-10 03:06:43,476 - lightgbm_train - INFO - 检测到时序窗口数据: 30 个时间步, 28 种特征类型
2025-08-10 03:06:43,476 - lightgbm_train - INFO - 时间窗口范围: step_00 到 step_29
2025-08-10 03:06:43,489 - lightgbm_train - INFO - 数据包含 5158 只股票
2025-08-10 03:06:43,489 - lightgbm_train - INFO - 每只股票的样本数量 - 最少: 6, 最多: 110, 平均: 109.1
2025-08-10 03:06:44,097 - lightgbm_train - INFO - 提取特征列 840 个: ['step_00_个股_开盘价', 'step_00_个股_收盘价', 'step_00_个股_最高价', 'step_00_个股_成交量', 'step_00_个股_涨跌幅']...
2025-08-10 03:06:44,097 - lightgbm_train - INFO - 数据加载完成: X.shape=(562593, 840), y.shape=(562593,)
2025-08-10 03:06:44,097 - lightgbm_train - INFO - 验证数据完整性...
2025-08-10 03:06:45,018 - lightgbm_train - INFO - 数据验证完成
2025-08-10 03:06:45,033 - lightgbm_train - INFO - 数据信息: CSV 格式
2025-08-10 03:06:45,041 - lightgbm_train - INFO - 处理异常值...
2025-08-10 03:06:45,938 - lightgbm_train - INFO - 异常值处理完成，移除了 21181 个样本
2025-08-10 03:06:45,947 - lightgbm_train - INFO - 开始预处理时序数据...
2025-08-10 03:06:45,947 - lightgbm_train - INFO - 输入数据形状: (541412, 840)
2025-08-10 03:06:45,947 - lightgbm_train - INFO - 检测到2D时序窗口数据，进行特征名称处理...
2025-08-10 03:06:45,947 - lightgbm_train - INFO - 使用时序窗口特征名称: 840 个step特征
2025-08-10 03:06:45,947 - lightgbm_train - INFO - 时序窗口结构: 30 个时间步 × 28 种特征
2025-08-10 03:06:45,947 - lightgbm_train - INFO - 时序数据预处理完成: (541412, 840) -> (541412, 840)
2025-08-10 03:06:45,951 - lightgbm_train - INFO - 为时序窗口数据计算技术指标...
2025-08-10 03:06:45,951 - lightgbm_train - INFO - 发现 7 种价格特征, 4 种成交量特征
2025-08-10 03:08:21,744 - lightgbm_train - INFO - 时序窗口技术指标特征添加完成: (541412, 840) -> (541412, 868)
2025-08-10 03:08:21,744 - lightgbm_train - INFO - 分割数据...
2025-08-10 03:08:22,981 - lightgbm_train - INFO - 数据分割完成: 训练集=378987, 验证集=54142, 测试集=108283
2025-08-10 03:08:22,985 - lightgbm_train - INFO - 数据清理：处理无穷值和NaN值...
2025-08-10 03:08:41,279 - lightgbm_train - INFO - 训练集数据清理完成
2025-08-10 03:08:41,325 - lightgbm_train - INFO - 验证集数据清理完成
2025-08-10 03:08:41,417 - lightgbm_train - INFO - 测试集数据清理完成
2025-08-10 03:08:41,417 - lightgbm_train - INFO - 使用 standard 方法进行数据标准化...
2025-08-10 03:08:44,222 - lightgbm_train - INFO - 进行特征选择...
2025-08-10 03:08:44,222 - lightgbm_train - INFO - 开始渐进式特征选择...
2025-08-10 03:08:44,222 - lightgbm_train - INFO - 执行阶段: remove_low_variance
2025-08-10 03:08:48,031 - lightgbm_train - INFO - remove_low_variance完成：移除了0个特征，剩余868个
2025-08-10 03:08:48,031 - lightgbm_train - INFO - 执行阶段: remove_highly_correlated
2025-08-10 03:08:55,681 - lightgbm_train - INFO - 基于相关性移除了 390 个高相关特征
2025-08-10 03:08:55,686 - lightgbm_train - INFO - remove_highly_correlated完成：移除了390个特征，剩余478个
2025-08-10 03:08:55,686 - lightgbm_train - INFO - 执行阶段: select_important_features
2025-08-10 03:09:16,617 - lightgbm_train - INFO - 基于重要性选择了 431 个特征
2025-08-10 03:09:16,619 - lightgbm_train - INFO - select_important_features完成：移除了47个特征，剩余431个
2025-08-10 03:09:16,619 - lightgbm_train - INFO - 渐进式特征选择完成：868 -> 431 个特征
2025-08-10 03:09:16,624 - lightgbm_train - INFO - 🚀 开始模型训练...
2025-08-10 03:09:24,643 - lightgbm_train - INFO - 模型训练完成
2025-08-10 03:09:24,643 - lightgbm_train - INFO - 评估模型性能...
2025-08-10 03:09:24,715 - lightgbm_train - INFO - MAPE计算时过滤了3190个接近零值的样本
2025-08-10 15:53:14,521 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-10 15:54:01,563 - __main__ - INFO - 开始LightGBM训练流程...
2025-08-10 15:54:02,457 - __main__ - WARNING - ['sz001221']
2025-08-10 15:57:55,605 - __main__ - INFO - 🚀 开始模型训练...
2025-08-10 15:57:58,601 - __main__ - INFO - 模型训练完成
