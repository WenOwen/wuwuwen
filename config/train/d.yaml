# LightGBM æ¶¨è·Œæ–¹å‘é¢„æµ‹é…ç½®æ–‡ä»¶
# é¢„æµ‹ä»»åŠ¡ï¼šçœ‹å¤šï¼ˆä¸Šæ¶¨ï¼‰vs çœ‹ç©ºï¼ˆä¸‹è·Œï¼‰
# äºŒåˆ†ç±»ä»»åŠ¡ï¼šæ¶¨å¹…>0ä¸ºçœ‹å¤š(1)ï¼Œæ¶¨å¹…<=0ä¸ºçœ‹ç©º(0)
# æ•°æ®åˆ†å‰²ï¼šåªä½¿ç”¨è®­ç»ƒé›†(80%)å’ŒéªŒè¯é›†(20%)ï¼Œä¸ä½¿ç”¨æµ‹è¯•é›†
# ðŸŽ¯ ä¼˜åŒ–ç›®æ ‡ï¼šç²¾ç¡®çŽ‡(PRECISION) - å‡å°‘è¯¯æŠ¥ï¼Œæé«˜é¢„æµ‹å‡†ç¡®æ€§

# ===========================================
# æ•°æ®é…ç½®
# ===========================================
data:
  # æ•°æ®è·¯å¾„é…ç½® - ç›´æŽ¥æŒ‡å‘professional_parquet
  data_dir: "./data/professional_parquet"
  
  # ç›´æŽ¥è®­ç»ƒé€‰é¡¹
  direct_training:
    enabled: true                    # å¯ç”¨ç›´æŽ¥è®­ç»ƒæ¨¡å¼
    data_format: "parquet"          # æ•°æ®æ ¼å¼
    stock_name_column: "name"       # è‚¡ç¥¨åç§°åˆ—
    target_column: "æ¶¨è·Œå¹…"          # ç”¨äºŽåˆ›å»ºæ–¹å‘é¢„æµ‹ç›®æ ‡
    prediction_mode: "direction"    # ðŸŽ¯ é¢„æµ‹æ¨¡å¼ï¼šdirection(æ–¹å‘) æˆ– regression(å›žå½’)
    exclude_columns:                # æŽ’é™¤çš„åˆ—ï¼ˆéžç‰¹å¾åˆ—ï¼‰
      - "name"                      # è‚¡ç¥¨åç§°ï¼ˆæ–‡æœ¬ï¼‰
      - "symbol"                    # è‚¡ç¥¨ä»£ç ï¼ˆæ ‡è¯†ç¬¦ï¼‰
      # æ³¨æ„ï¼šæ¶¨è·Œå¹…ä½œä¸ºç‰¹å¾ç”¨äºŽé¢„æµ‹æ¬¡æ—¥æ¶¨è·Œæ–¹å‘
    
  # æ•°æ®åŠ è½½é€‰é¡¹
  loading_options:
    encoding: "utf-8"
    validate_data: true
    
  # æ•°æ®é¢„å¤„ç†ï¼ˆç®€åŒ–ç‰ˆï¼‰
  preprocessing:
    # æ•°æ®æ ‡å‡†åŒ–ï¼ˆæŽ¨èä¿ç•™ï¼‰
    normalization:
      method: "robust"  # robustæ ‡å‡†åŒ–å¯¹å¼‚å¸¸å€¼æ›´é²æ£’
      
    # å¼‚å¸¸å€¼å¤„ç†ï¼ˆæŽ¨èä¿ç•™ï¼‰
    outlier_handling:
      enabled: true
      method: "winsorize"
      winsorize_limits: [0.01, 0.01]  # 1%å’Œ99%åˆ†ä½æ•°æˆªæ–­

# ===========================================
# è®­ç»ƒé…ç½®
# ===========================================
training:
  # æ•°æ®åˆ†å‰² - åªä½¿ç”¨è®­ç»ƒé›†å’ŒéªŒè¯é›†
  data_split:
    # test_size: å·²åˆ é™¤ï¼Œä¸å†ä½¿ç”¨æµ‹è¯•é›†
    validation_size: 0.2            # ðŸŽ¯ å¢žåŠ éªŒè¯é›†æ¯”ä¾‹ï¼Œè¡¥å……åˆ é™¤æµ‹è¯•é›†åŽçš„æ•°æ®åˆ©ç”¨
    random_state: 42
    # stratify: true                # ðŸŽ¯ æ—¶åºåˆ†å‰²ä¸­ä¸é€‚ç”¨åˆ†å±‚æŠ½æ ·
    # ðŸŽ¯ æ¬¡æ—¥é¢„æµ‹å¿…é¡»ä½¿ç”¨æ—¶é—´åºåˆ—åˆ†å‰²ï¼Œé¿å…æœªæ¥ä¿¡æ¯æ³„éœ²
    time_series_split: true
    
  # è®­ç»ƒå‚æ•°
  training_params:
    early_stopping_rounds: 100
    verbose: 10
    eval_metric: ["precision", "binary_logloss", "auc"]  # ðŸŽ¯ äºŒåˆ†ç±»è¯„ä¼°æŒ‡æ ‡

# ===========================================
# LightGBM æ¨¡åž‹å‚æ•°ï¼ˆäºŒåˆ†ç±»ï¼‰
# ===========================================
lightgbm:
  # åŸºç¡€å‚æ•°
  basic_params:
    objective: "binary"             # ðŸŽ¯ äºŒåˆ†ç±»ä»»åŠ¡
    metric: "binary_logloss"      # ðŸŽ¯ ç²¾ç¡®çŽ‡æŒ‡æ ‡
    boosting_type: "gbdt"
    num_leaves: 63
    learning_rate: 0.05
    feature_fraction: 0.8
    bagging_fraction: 0.8
    bagging_freq: 5
    verbose: -1
    random_state: 42
    
  # è¿›é˜¶å‚æ•°
  advanced_params:
    max_depth: 6
    min_data_in_leaf: 50
    min_gain_to_split: 0.1
    lambda_l1: 0
    lambda_l2: 1
    min_data_in_bin: 3
    bin_construct_sample_cnt: 200000
    
  # è®­ç»ƒå‚æ•°
  fit_params:
    num_boost_round: 1000

# ===========================================
# ç‰¹å¾é€‰æ‹©
# ===========================================
feature_selection:
  enabled: true
  methods:
    # åŸºäºŽé‡è¦æ€§çš„é€‰æ‹©
    importance_based:
      enabled: true
      threshold: 0.001  # é‡è¦æ€§é˜ˆå€¼
      
    # åŸºäºŽç›¸å…³æ€§çš„é€‰æ‹©
    correlation_based:
      enabled: true
      threshold: 0.95   # ç›¸å…³æ€§é˜ˆå€¼

# ===========================================
# è¶…å‚æ•°ä¼˜åŒ–ï¼ˆå¾ªçŽ¯è°ƒå‚ï¼‰
# ===========================================
hyperparameter_tuning:
  enabled: true                    # ðŸŽ¯ å¯ç”¨å¾ªçŽ¯è°ƒå‚
  
  # è°ƒå‚ç­–ç•¥
  strategy: "grid_search"        # ðŸŽ¯ æ”¹ä¸ºéšæœºæœç´¢ï¼Œé¿å…ç»„åˆçˆ†ç‚¸
  max_trials: 50                   # æœ€å¤§å°è¯•æ¬¡æ•°ï¼ˆrandom_searchæ—¶æœ‰æ•ˆï¼‰
  
  # è¯„ä¼°æŒ‡æ ‡ï¼ˆç”¨äºŽé€‰æ‹©æœ€ä½³å‚æ•°ï¼‰
  optimization_metric: "precision" # ðŸŽ¯ ä¼˜åŒ–ç›®æ ‡ï¼šç²¾ç¡®çŽ‡(precision)
  optimization_direction: "maximize"  # maximize(æœ€å¤§åŒ–) æˆ– minimize(æœ€å°åŒ–)
  
  # å‚æ•°æœç´¢ç©ºé—´ï¼ˆç²¾ç®€ç‰ˆï¼Œä¸“æ³¨äºŽç²¾ç¡®çŽ‡ä¼˜åŒ–ï¼‰
  param_space:
    # ðŸŽ¯ æ ¸å¿ƒå‚æ•°ï¼šå¯¹ç²¾ç¡®çŽ‡å½±å“æœ€å¤§
    learning_rate: [0.01, 0.03, 0.05, 0.08, 0.1]          # å­¦ä¹ çŽ‡
    num_leaves: [31, 63, 127]                  # å¶å­æ•°
    max_depth: [4, 6, 8]                       # æœ€å¤§æ·±åº¦
    
    # ðŸŽ¯ æ­£åˆ™åŒ–å‚æ•°ï¼šé˜²æ­¢è¿‡æ‹Ÿåˆï¼Œæå‡æ³›åŒ–æ€§èƒ½
    lambda_l1: [0, 0.1]                        # L1æ­£åˆ™åŒ–ï¼ˆå‡å°‘å‚æ•°ï¼‰
    lambda_l2: [0.5, 1.0, 2.0]                 # L2æ­£åˆ™åŒ–ï¼ˆé‡è¦ï¼‰
    
    # ðŸŽ¯ æ•°æ®é‡‡æ ·ï¼šå½±å“æ¨¡åž‹ç¨³å®šæ€§
    min_data_in_leaf: [20, 50]                 # å¶å­æœ€å°æ ·æœ¬æ•°
    min_gain_to_split: [0.0, 0.1]              # åˆ†è£‚æœ€å°å¢žç›Š
  
  # ç»“æžœä¿å­˜
  results_save:
    save_all_trials: true           # ä¿å­˜æ‰€æœ‰å°è¯•çš„ç»“æžœ
    save_best_model: true           # ä¿å­˜æœ€ä½³æ¨¡åž‹
    detailed_log: true              # è¯¦ç»†æ—¥å¿—
    
  # æ—©åœè®¾ç½®ï¼ˆé’ˆå¯¹æ¯æ¬¡å°è¯•ï¼‰
  early_stopping:
    patience: 50                    # æ—©åœè½®æ•°
    min_improvement: 0.001          # æœ€å°æ”¹è¿›å¹…åº¦

# ===========================================
# è¾“å‡ºé…ç½®
# ===========================================
output:
  file_naming:
    identifier_type: "unique_id"
    unique_id_digits: 3
    folder_name_prefix: "direction_training"
    show_id_in_log: true
  
  model_save:
    save_dir: "./models/lightgbm_direction"
    model_name: "lightgbm_direction_model"
    save_format: ["pkl"]
    
  results_save:
    save_dir: "./results/lightgbm_direction"
    save_predictions: true         # ðŸŽ¯ åªä¿å­˜éªŒè¯é›†é¢„æµ‹ç»“æžœ
    save_feature_importance: true
    save_metrics: true             # ðŸŽ¯ åªåŒ…å«trainå’Œvalè¯„ä¼°æŒ‡æ ‡
    save_visualizations: true      # ðŸŽ¨ å¯ç”¨å¯è§†åŒ–å›¾è¡¨ï¼ˆtrain+valï¼‰
    
  logging:
    log_level: "INFO"
    log_file: "./logs/lightgbm_direction_training.log"
    console_output: true

# ===========================================
# è¯„ä¼°é…ç½®ï¼ˆäºŒåˆ†ç±»ï¼‰
# æ³¨æ„ï¼šè¯„ä¼°åªé’ˆå¯¹è®­ç»ƒé›†å’ŒéªŒè¯é›†ï¼Œä¸åŒ…å«æµ‹è¯•é›†
# ===========================================
evaluation:
  # åˆ†ç±»é˜ˆå€¼è®¾å®š
  classification_threshold: 0.5     # äºŒåˆ†ç±»é˜ˆå€¼ï¼Œé»˜è®¤0.5
  
  metrics:
    - "precision"              # ðŸŽ¯ ç²¾ç¡®çŽ‡ï¼ˆä¸»è¦ä¼˜åŒ–ç›®æ ‡ï¼‰
    - "recall"                 # å¬å›žçŽ‡
    - "f1_score"               # F1åˆ†æ•°
    - "accuracy"               # å‡†ç¡®çŽ‡
    - "auc"                    # AUC-ROC
    - "log_loss"               # å¯¹æ•°æŸå¤±

# ===========================================
# å…¶ä»–é…ç½®
# ===========================================
misc:
  n_jobs: -1
  memory_optimization:
    enabled: true
    chunk_size: 10000
  random_seed: 42