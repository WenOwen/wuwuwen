# LightGBM æ¶¨è·Œæ–¹å‘é¢„æµ‹é…ç½®æ–‡ä»¶ - é˜²è¿‡æ‹Ÿåˆç‰ˆæœ¬
# é¢„æµ‹ä»»åŠ¡ï¼šçœ‹å¤šï¼ˆä¸Šæ¶¨ï¼‰vs çœ‹ç©ºï¼ˆä¸‹è·Œï¼‰
# é’ˆå¯¹è¿‡æ‹Ÿåˆä¼˜åŒ–çš„å‚æ•°é…ç½®

# ===========================================
# æ•°æ®é…ç½®
# ===========================================
data:
  # æ•°æ®è·¯å¾„é…ç½® - ç›´æ¥æŒ‡å‘professional_parquet
  data_dir: "./data/professional_parquet"
  
  # ç›´æ¥è®­ç»ƒé€‰é¡¹
  direct_training:
    enabled: true                    # å¯ç”¨ç›´æ¥è®­ç»ƒæ¨¡å¼
    data_format: "parquet"          # æ•°æ®æ ¼å¼
    stock_name_column: "name"       # è‚¡ç¥¨åç§°åˆ—
    target_column: "æ¶¨è·Œå¹…"          # ç”¨äºåˆ›å»ºæ–¹å‘é¢„æµ‹ç›®æ ‡
    prediction_mode: "direction"    # ğŸ¯ é¢„æµ‹æ¨¡å¼ï¼šdirection(æ–¹å‘) æˆ– regression(å›å½’)
    exclude_columns:                # æ’é™¤çš„åˆ—ï¼ˆéç‰¹å¾åˆ—ï¼‰
      - "name"                      # è‚¡ç¥¨åç§°ï¼ˆæ–‡æœ¬ï¼‰
      - "symbol"                    # è‚¡ç¥¨ä»£ç ï¼ˆæ ‡è¯†ç¬¦ï¼‰
    
  # æ•°æ®åŠ è½½é€‰é¡¹
  loading_options:
    encoding: "utf-8"
    validate_data: true
    
  # æ•°æ®é¢„å¤„ç†ï¼ˆå¢å¼ºç‰ˆï¼‰
  preprocessing:
    # æ•°æ®æ ‡å‡†åŒ–ï¼ˆä½¿ç”¨æ›´ç¨³å¥çš„æ–¹æ³•ï¼‰
    normalization:
      method: "robust"  # robustæ ‡å‡†åŒ–å¯¹å¼‚å¸¸å€¼æ›´é²æ£’
      
    # å¼‚å¸¸å€¼å¤„ç†ï¼ˆæ›´ä¸¥æ ¼ï¼‰
    outlier_handling:
      enabled: true
      method: "winsorize"
      winsorize_limits: [0.02, 0.02]  # æ›´ä¸¥æ ¼çš„2%å’Œ98%åˆ†ä½æ•°æˆªæ–­

# ===========================================
# è®­ç»ƒé…ç½®ï¼ˆé˜²è¿‡æ‹Ÿåˆä¼˜åŒ–ï¼‰
# ===========================================
training:
  # æ•°æ®åˆ†å‰²
  data_split:
    test_size: 0.2
    validation_size: 0.15           # ğŸ”§ å¢åŠ éªŒè¯é›†æ¯”ä¾‹
    random_state: 42
    stratify: true                  # åˆ†ç±»ä»»åŠ¡ä½¿ç”¨åˆ†å±‚æŠ½æ ·
    time_series_split: true         # æ—¶é—´åºåˆ—åˆ†å‰²
    
  # è®­ç»ƒå‚æ•°ï¼ˆé˜²è¿‡æ‹Ÿåˆï¼‰
  training_params:
    early_stopping_rounds: 50       # ğŸ”§ å‡å°‘early stoppingè½®æ•°ï¼Œæ›´æ—©åœæ­¢
    verbose: 50
    eval_metric: ["auc", "binary_logloss"]

# ===========================================
# LightGBM æ¨¡å‹å‚æ•°ï¼ˆé˜²è¿‡æ‹Ÿåˆä¼˜åŒ–ï¼‰
# ===========================================
lightgbm:
  # åŸºç¡€å‚æ•°
  basic_params:
    objective: "binary"             # äºŒåˆ†ç±»ä»»åŠ¡
    metric: "auc"                   # AUCæŒ‡æ ‡
    boosting_type: "gbdt"
    num_leaves: 31                  # ğŸ”§ å‡å°‘å¶å­æ•°é‡ï¼ˆåŸ63â†’31ï¼‰
    learning_rate: 0.03             # ğŸ”§ é™ä½å­¦ä¹ ç‡ï¼ˆåŸ0.05â†’0.03ï¼‰
    feature_fraction: 0.7           # ğŸ”§ é™ä½ç‰¹å¾é‡‡æ ·ç‡ï¼ˆåŸ0.8â†’0.7ï¼‰
    bagging_fraction: 0.7           # ğŸ”§ é™ä½æ ·æœ¬é‡‡æ ·ç‡ï¼ˆåŸ0.8â†’0.7ï¼‰
    bagging_freq: 3                 # ğŸ”§ å¢åŠ baggingé¢‘ç‡
    verbose: -1
    random_state: 42
    
  # è¿›é˜¶å‚æ•°ï¼ˆå¢å¼ºæ­£åˆ™åŒ–ï¼‰
  advanced_params:
    max_depth: 5                    # ğŸ”§ é™åˆ¶æœ€å¤§æ·±åº¦ï¼ˆåŸ6â†’5ï¼‰
    min_data_in_leaf: 100           # ğŸ”§ å¢åŠ å¶å­èŠ‚ç‚¹æœ€å°æ ·æœ¬æ•°ï¼ˆåŸ50â†’100ï¼‰
    min_gain_to_split: 0.2          # ğŸ”§ å¢åŠ åˆ†è£‚æœ€å°å¢ç›Šï¼ˆåŸ0.1â†’0.2ï¼‰
    lambda_l1: 0.2                  # ğŸ”§ å¢åŠ L1æ­£åˆ™åŒ–ï¼ˆåŸ0.1â†’0.2ï¼‰
    lambda_l2: 0.2                  # ğŸ”§ å¢åŠ L2æ­£åˆ™åŒ–ï¼ˆåŸ0.1â†’0.2ï¼‰
    min_data_in_bin: 5              # ğŸ”§ å¢åŠ åˆ†ç®±æœ€å°æ ·æœ¬æ•°
    bin_construct_sample_cnt: 100000 # ğŸ”§ å‡å°‘åˆ†ç®±æ„å»ºæ ·æœ¬æ•°
    max_bin: 255                    # ğŸ”§ é™åˆ¶æœ€å¤§åˆ†ç®±æ•°
    
  # è®­ç»ƒå‚æ•°
  fit_params:
    num_boost_round: 500            # ğŸ”§ å‡å°‘æœ€å¤§è¿­ä»£æ•°ï¼ˆåŸ1000â†’500ï¼‰

# ===========================================
# ç‰¹å¾é€‰æ‹©ï¼ˆå¢å¼ºç‰ˆï¼‰
# ===========================================
feature_selection:
  enabled: true
  methods:
    # åŸºäºé‡è¦æ€§çš„é€‰æ‹©
    importance_based:
      enabled: true
      threshold: 0.002              # ğŸ”§ æé«˜é‡è¦æ€§é˜ˆå€¼
      
    # åŸºäºç›¸å…³æ€§çš„é€‰æ‹©
    correlation_based:
      enabled: true
      threshold: 0.90               # ğŸ”§ æ›´ä¸¥æ ¼çš„ç›¸å…³æ€§é˜ˆå€¼

# ===========================================
# è¶…å‚æ•°ä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰
# ===========================================
hyperparameter_tuning:
  enabled: false

# ===========================================
# è¾“å‡ºé…ç½®
# ===========================================
output:
  file_naming:
    identifier_type: "unique_id"
    unique_id_digits: 3
    folder_name_prefix: "direction_robust"  # ğŸ”§ åŒºåˆ«äºæ™®é€šç‰ˆæœ¬
    show_id_in_log: true
  
  model_save:
    save_dir: "./models/lightgbm_direction_robust"
    model_name: "lightgbm_direction_robust_model"
    save_format: ["pkl"]
    
  results_save:
    save_dir: "./results/lightgbm_direction_robust"
    save_predictions: true
    save_feature_importance: true
    save_metrics: true
    
  logging:
    log_level: "INFO"
    log_file: "./logs/lightgbm_direction_robust_training.log"
    console_output: true

# ===========================================
# è¯„ä¼°é…ç½®ï¼ˆäºŒåˆ†ç±»ï¼‰
# ===========================================
evaluation:
  metrics:
    - "auc"                         # AUC-ROC
    - "accuracy"                    # å‡†ç¡®ç‡
    - "precision"                   # ç²¾ç¡®ç‡
    - "recall"                      # å¬å›ç‡
    - "f1_score"                    # F1åˆ†æ•°
    - "log_loss"                    # å¯¹æ•°æŸå¤±

# ===========================================
# å…¶ä»–é…ç½®
# ===========================================
misc:
  n_jobs: -1
  memory_optimization:
    enabled: true
    chunk_size: 8000                # ğŸ”§ å‡å°‘chunkå¤§å°
  random_seed: 42

# ===========================================
# é˜²è¿‡æ‹Ÿåˆç­–ç•¥è¯´æ˜
# ===========================================
# 1. æ¨¡å‹å¤æ‚åº¦æ§åˆ¶ï¼š
#    - num_leaves: 63â†’31 (å‡å°‘æ¨¡å‹å¤æ‚åº¦)
#    - max_depth: 6â†’5 (é™åˆ¶æ ‘æ·±åº¦)
#    - min_data_in_leaf: 50â†’100 (å¢åŠ å¶å­èŠ‚ç‚¹æ ·æœ¬æ•°)
#
# 2. æ­£åˆ™åŒ–å¢å¼ºï¼š
#    - lambda_l1: 0.1â†’0.2 (å¢åŠ L1æ­£åˆ™åŒ–)
#    - lambda_l2: 0.1â†’0.2 (å¢åŠ L2æ­£åˆ™åŒ–)
#    - min_gain_to_split: 0.1â†’0.2 (å¢åŠ åˆ†è£‚é˜ˆå€¼)
#
# 3. éšæœºæ€§å¢åŠ ï¼š
#    - feature_fraction: 0.8â†’0.7 (å‡å°‘ç‰¹å¾é‡‡æ ·)
#    - bagging_fraction: 0.8â†’0.7 (å‡å°‘æ ·æœ¬é‡‡æ ·)
#    - bagging_freq: 5â†’3 (å¢åŠ é‡‡æ ·é¢‘ç‡)
#
# 4. è®­ç»ƒæ§åˆ¶ï¼š
#    - learning_rate: 0.05â†’0.03 (é™ä½å­¦ä¹ ç‡)
#    - early_stopping: 100â†’50 (æ›´æ—©åœæ­¢)
#    - num_boost_round: 1000â†’500 (å‡å°‘æœ€å¤§è¿­ä»£)
#
# 5. æ•°æ®è´¨é‡ï¼š
#    - validation_size: 0.1â†’0.15 (å¢åŠ éªŒè¯é›†)
#    - winsorize_limits: [0.01,0.01]â†’[0.02,0.02] (æ›´ä¸¥æ ¼å¼‚å¸¸å€¼å¤„ç†)