# 涨跌方向预测功能使用说明

## 🎯 新增功能

训练脚本现在支持两种预测模式：

### 1. 回归预测模式（原有功能）
- **目标**：预测明天的具体涨跌幅数值
- **输出**：连续数值（如 +2.5%, -1.8%）
- **评估指标**：RMSE, MAE, R², 方向准确率

### 2. 涨跌方向预测模式（🆕新功能）
- **目标**：预测明天是看多还是看空
- **输出**：二分类标签（看多=1, 看空=0）
- **评估指标**：AUC, 准确率, 精确率, 召回率, F1分数

## 📊 方向预测逻辑

**分类规则**：
- **看多 (1)**：明天涨跌幅 > 0
- **看空 (0)**：明天涨跌幅 ≤ 0

## 🔧 使用方法

### 配置文件设置

#### 方向预测模式（新配置）
```yaml
# 使用新的配置文件
config/train/lightGBM_direction_predict.yaml

# 关键设置：
data:
  direct_training:
    prediction_mode: "direction"  # 🎯 设置为方向预测
    
lightgbm:
  basic_params:
    objective: "binary"           # 🎯 二分类任务
    metric: "auc"                # 🎯 AUC指标
    
evaluation:
  metrics:
    - "auc"                      # AUC-ROC
    - "accuracy"                 # 准确率
    - "precision"                # 精确率
    - "recall"                   # 召回率
    - "f1_score"                 # F1分数
```

#### 回归预测模式（原有）
```yaml
# 使用原有配置文件
config/train/lightGBM_direct_train.yaml

# 关键设置：
data:
  direct_training:
    prediction_mode: "regression"  # 或者不设置（默认回归）
    
lightgbm:
  basic_params:
    objective: "regression"        # 回归任务
    metric: "rmse"                # RMSE指标
```

### 运行训练

#### 方向预测训练
```bash
python lightgbm_stock_train.py --config config/train/lightGBM_direction_predict.yaml
```

#### 回归预测训练（原有）
```bash
python lightgbm_stock_train.py --config config/train/lightGBM_direct_train.yaml
```

## 📈 输出示例

### 方向预测模式输出
```
🎯 预测模式: 涨跌方向预测（二分类）
📊 看多样本: 234,567 (48.2%)
📊 看空样本: 251,433 (51.8%)

📈 评估结果 (方向预测):
  TRAIN:
    auc: 0.678420
    accuracy: 61.24%
    precision: 0.595123
    recall: 0.642801
    f1_score: 0.618234
    
  TEST:
    auc: 0.654321
    accuracy: 58.76%
    precision: 0.571234
    recall: 0.612345
    f1_score: 0.591234
```

### 回归预测模式输出
```
📈 预测模式: 涨跌幅预测（回归）
📊 目标值范围: [-0.0987, 0.1023]

📈 评估结果 (回归预测):
  TRAIN:
    rmse: 0.024567
    mae: 0.018234
    r2_score: 0.134567
    directional_accuracy: 57.23%
    
  TEST:
    rmse: 0.027891
    mae: 0.020123
    r2_score: 0.089456
    directional_accuracy: 54.67%
```

## 🎯 模式对比

| 特性 | 回归预测 | 方向预测 |
|------|---------|---------|
| 预测目标 | 具体涨跌幅 | 涨跌方向 |
| 模型类型 | 回归 | 二分类 |
| 输出范围 | 连续数值 | 0或1 |
| 主要指标 | RMSE, R² | AUC, 准确率 |
| 业务应用 | 量化投资 | 择时策略 |
| 模型复杂度 | 较高 | 较低 |
| 解释性 | 较低 | 较高 |

## 💡 使用建议

### 方向预测适用场景
- **择时策略**：判断何时买入/卖出
- **风险控制**：预测市场转向
- **策略筛选**：过滤交易信号
- **初步分析**：快速判断市场情绪

### 回归预测适用场景
- **量化投资**：精确的收益预测
- **投资组合**：权重分配优化
- **风险建模**：精确的风险度量
- **高频交易**：精细的价格预测

## 🔄 切换模式

只需要修改配置文件中的 `prediction_mode` 参数：

```yaml
# 方向预测
prediction_mode: "direction"

# 回归预测  
prediction_mode: "regression"
```

训练脚本会自动：
- 调整目标变量转换
- 选择合适的模型参数
- 使用对应的评估指标
- 输出相应的结果格式

## ⚠️ 注意事项

1. **数据一致性**：两种模式使用相同的特征数据
2. **评估指标**：不同模式的指标不能直接比较
3. **业务目标**：根据实际需求选择合适的模式
4. **模型调优**：不同模式可能需要不同的超参数

## 📁 文件结构

```
├── config/train/
│   ├── lightGBM_direct_train.yaml      # 回归预测配置
│   └── lightGBM_direction_predict.yaml # 方向预测配置
├── models/
│   ├── lightgbm_direct/               # 回归模型
│   └── lightgbm_direction/            # 方向预测模型
└── results/
    ├── lightgbm_direct/               # 回归结果
    └── lightgbm_direction/            # 方向预测结果
```

现在你可以根据不同的业务需求选择合适的预测模式了！🚀